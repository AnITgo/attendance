<!doctype html>
<html>
<head>
		<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <!--自适应界面,如果出现,在某些设备出现界面偏小的话,检查一下有没有加入这句 -->
    <meta http-equiv="Content-type" name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width">
		<title>登录</title>
		<link type="text/css" rel="stylesheet" href="./assets/css/bootstrap.css"/>
    <link type="text/css" rel="stylesheet" href="./assets/css/bootstrap-select.css"/>
    <link type="text/css" rel="stylesheet" href="./assets/css/question-content.css"/>

    <script type="text/javascript" src="./assets/js/jquery.js"></script>
    <script type="text/javascript" src="./assets/js/jquery.validate.js"></script>
    <script type="text/javascript" src="./assets/js/bootstrap.js"></script>
    <script type="text/javascript" src="./assets/js/messages_cn.js"></script>

    <script type="text/javascript" src="./assets/js/bootstrap-select.js"></script>

    <link rel="stylesheet" href="./assets/js/jqueryui/jquery-ui.min.css">
  <script src="./assets/js/jqueryui/jquery.min.js"></script>
  <script src="./assets/js/jqueryui/jquery-ui.min.js"></script>
   <link rel="./assets/js/jqueryui/style.css">
	</head>
<body>
  <div class="container">
  <div class="panel panel-primary">
    <div class="panel-heading">
      <h3 class="panel-title">查询</h3>
    </div>
    <div class="panel-body">
      <form id="staff_search_form" method="post" class="form-horizontal"  enctype="multipart/form-data" action="<?php echo site_url('search/staff_search')?>" >
        <fieldset>
        <div class="row">
          <div class="col-md-6">            
            <div class="form-group">
              <label class="col-lg-2 col-xs-4 control-label">部门:</label>
              <div class="col-lg-8 col-xs-8">
                <select name="department_select" id="department_select" class="form-control" data-live-search="true"  data-style="btn-primary" onchange="find_project_teams_from_department(this.value)">
                    
                    <option value="0">--不限--</option>
                    <?php foreach ($departments as $item) :?>
                      <option value="<?=$item['id']?>" 
                        <?php if (isset($department_selected)&&$item['id']==$department_selected): ?>
                        selected="selected"
                        <?php endif ?>
                      >
                      <?=$item['name']?>
                      </option>
                    <?php endforeach; ?>
                </select>
                <br>
              </div>
              <div class="col-lg-2"></div>
            </div>        
            
          </div>

          

          <div class="col-md-6">
            <div class="form-group">
              <label class="col-lg-2 col-xs-4 control-label">项目组:</label>
              <div id='relative_project_teams' class="col-lg-8 col-xs-8" >
                <select name="relative_project_team_select" id="relative_project_team_select" title="选择项目组" class="form-control"  data-live-search="true"  data-style="btn-primary">
                  <option value="0">--不限--</option>
                  <?php foreach ($project_teams as $item):?>
                    <option value="<?=$item['id']?>"<?php if (isset($project_team_selected)&&$item['id']==$project_team_selected): ?>
                        selected="selected"
                        <?php endif ?>>
                    <?=$item['name']?>
                    </option>
                  <?php endforeach; ?>
                </select>
              </div>
              
            </div>            
          </div>
        </div>

        

        <div class="row">
          <div class="col-md-6">
            <div class="form-group">
              <label class="col-lg-2 col-xs-4 control-label">姓名:</label>
              <div class="col-lg-8 col-xs-8">
                <input class="form-control" id="staff_name" name="staff_name"
                  <?php if (isset($staff_name_selected)): ?>
                    value="<?=$staff_name_selected?>"
                  <?php endif ?>
                />
              </div>

            </div>
            
            
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <label class="col-lg-2 col-xs-4 control-label">假期类型:</label>
              <div class="col-lg-8 col-xs-8">
                <select class="form-control" name="vacation_type" id="vacation_type">
                  <option value="0">--不限--</option>
                  <?php foreach ($vacation_types as $item) :?>
                    <option value="<?=$item['vacation_type']?>" 
                    <?php if (isset($vacation_type_selected)&&$item['vacation_type']==$vacation_type_selected): ?>
                      selected="selected"
                    <?php endif ?>
                  >
                      <?=$item['vacation_type']?>
                    </option>
                  <?php endforeach; ?>
                </select>
              </div>

            </div>


          </div>
        </div>

        <div class="row">
          <div class="col-md-6">
            <div class="form-group">
              <label class="col-lg-2 col-xs-4 control-label">工号:</label>
              <div class="col-lg-8 col-xs-8">
                <input class="form-control" id="job_number" name="job_number"
                  <?php if (isset($job_number_selected)): ?>
                    value="<?=$job_number_selected?>"
                  <?php endif ?>
                />

              </div>

            </div>
            
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <label class="col-lg-2 col-xs-4 control-label">加班类型:</label>
              <div class="col-lg-8 col-xs-8">
                <select class="form-control" name="overtime_type" id="overtime_type">
                  <option value="0">--不限--</option>
                  <?php foreach ($overtime_types as $item) :?>
                    <option value="<?=$item['overtime_type']?>" 
                    <?php if (isset($overtime_type_selected)&&$item['overtime_type']==$overtime_type_selected): ?>
                      selected="selected"
                    <?php endif ?>
                  >
                      <?=$item['overtime_type']?>
                    </option>
                  <?php endforeach; ?>
                </select>
              </div>

            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-6">
            <div class="form-group">
              <label class="col-lg-2 col-xs-4 control-label">角色:</label>
              <div class="col-lg-8 col-xs-8">
                <select class="form-control" name="role_id" id="role_id">
                  <option value="0">--不限--</option>
                  <?php foreach ($roles as $item) :?>
                    <option value="<?=$item['id']?>" 
                    <?php if (isset($role_selected)&&$item['id']==$role_selected): ?>
                      selected="selected"
                    <?php endif ?>
                  >
                      <?=$item['name']?>
                    </option>
                  <?php endforeach; ?>
                </select>
              </div>

            </div>
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <label class="col-lg-2 col-xs-4 control-label">进度:</label>
              <div class="col-lg-8 col-xs-8">
                <select class="form-control" name="progress_id" id="progress_id">
                  <option value="0">--不限--</option>
                  <?php foreach ($progress as $item) :?>
                    <option value="<?=$item['id']?>" 
                    <?php if (isset($progress_selected)&&$item['id']==$progress_selected): ?>
                      selected="selected"
                    <?php endif ?>
                  >
                      <?=$item['name']?>
                    </option>
                  <?php endforeach; ?>
                </select>
              </div>

            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-6">
            <div class="form-group">
            <label class="col-lg-2 col-xs-4 control-label">日期:</label>
            <div class="col-lg-10 col-xs-8">
              <div class="input-group date form_date col-md-9" data-date="" data-date-format="yyyy-mm-dd" data-link-field="dtp_input2" data-link-format="yyyy-mm-dd">
                         <input class="form-control" id="date" name="date"type="text"readonly <?php if (isset($date_selected)): ?>
                    value="<?=$date_selected?>"<?php endif ?>>
                        <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
              <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
                      </div>
            </div>               
                  </div>
          </div>

          <div class="col-md-6">
            <div class="form-group">
              <div class="col-lg-10 col-lg-offset-2">
                <button type="submit" class="btn btn-primary">查询</button>
                
              </div>
            </div>
          </div>
        </div>
        </fieldset>
      </form>
    </div>
  </div>
  <div class="panel panel-default">
    <div class="panel-body">
      <ul class="nav nav-tabs">
        <li id="vacation_tab_li"><a href="#vacation_tab" data-toggle="tab" aria-expanded="true">请假人员列表</a></li>
        <li id="overtime_tab_li"><a href="#overtime_tab" data-toggle="tab" aria-expanded="true">加班人员列表</a></li>
        <li id="business_tab_li"><a href="#business_tab" data-toggle="tab" aria-expanded="true">出差人员列表</a></li>
      </ul>
      <div id="myTabContent" class="tab-content">
        <div class="tab-pane fade" id="vacation_tab">
          <div id="table"  class="table-responsive">
            <table id="vactionTable" class="table table-striped table-hover ">
              
            <thead>
            <tr>
              <th>部门</th>
              <th>项目组</th>
              <th>姓名(工号)</th>
              <th>类型</th>
              <th>开始时间</th>
              <th>结束时间</th>
              <th>状态</th>
              
            </tr>
          </thead>
          <tbody>
            <?php $index=1; ?>
            <?php foreach ($vacation_apply as $item ): ?>
            <tr>
              <td>
                <?php $index++ ;echo $item['department_name']?></td>
              <td>
                <?php echo $item['project_team_name']?></td>
              <td>
                <?php echo $item['staff_name']?>(<?php echo $item['job_number']?>)</td>
              <td>
                <?php echo $item['vacation_type']?>
                </td>
              <td>
                <?php echo $item['start_date']?>
              </td>
              <td>
                <?php echo $item['end_date']?>
              </td>
              <td>
                <?php if($item['department_manager_state']==0&&$item['state']==0) {?>
                  等待部门经理审批
                <?php } ?>
                <?php if($item['department_manager_state']==1&&$item['vice_manager_state']==0&&$item['state']==0) {?>
                  等待副总经理审批
                <?php } ?>
                <?php if($item['department_manager_state']==1&&$item['vice_manager_state']==1&&$item['general_manager_state']==0&&$item['state']==0) {?>
                  等待总经理审批
                <?php } ?>
                <?php if($item['state']==1&&$item['result']==1) {?>
                  申请成功
                <?php } ?>
                <?php if($item['state']==1&&$item['result']==2) {?>
                  申请失败
                <?php } ?>
              </td>
            </tr>
            <?php endforeach; ?></tbody>
        
            </table>
          </div>
        </div>
        <div class="tab-pane fade" id="overtime_tab">
        <div id="table"  class="table-responsive">
          <table id="overtimeTable" class="table table-striped table-hover ">
              <thead>
            <tr>
              <th>部门</th>
              <th>项目组</th>
              <th>姓名(工号)</th>
              <th>类型</th>
              <th>开始时间</th>
              <th>结束时间</th>
              <th>状态</th>
              
            </tr>
          </thead>
          <tbody>
            <?php $index=1; ?>
            <?php foreach ($overtime_apply as $item ): ?>
            <tr>
              <td>
                <?php $index++ ;echo $item['department_name']?></td>
              <td>
                <?php echo $item['project_team_name']?></td>
              <td>
                <?php echo $item['staff_name']?>(<?php echo $item['job_number']?>)</td>
              <td>
                <?php echo $item['overtime_type']?>
                </td>
              <td>
                <?php echo $item['start_date']?>
              </td>
              <td>
                <?php echo $item['end_date']?>
              </td>
              <td>
                <?php if($item['department_manager_state']==0&&$item['state']==0) {?>
                  等待部门经理审批
                <?php } ?>
                <?php if($item['department_manager_state']==1&&$item['vice_manager_state']==0&&$item['state']==0) {?>
                  等待副总经理审批
                <?php } ?>
                <?php if($item['department_manager_state']==1&&$item['vice_manager_state']==1&&$item['general_manager_state']==0&&$item['state']==0) {?>
                  等待总经理审批
                <?php } ?>
                <?php if($item['state']==1&&$item['result']==1) {?>
                  申请成功
                <?php } ?>
                <?php if($item['state']==1&&$item['result']==2) {?>
                  申请失败
                <?php } ?>
              </td>
            </tr>
            <?php endforeach; ?></tbody>
            </table>
          </div>
        </div>
        <div class="tab-pane fade" id="business_tab">
        <div id="table"  class="table-responsive">
          <table id="businesstable" class="table table-striped table-hover ">
              <thead>
            <tr>
              <th>部门</th>
              <th>项目组</th>
              <th>姓名(工号)</th>
              <th>开始时间</th>
              <th>结束时间</th>
              <th>状态</th>
            </tr>
          </thead>
          <tbody>
            <?php $index=1; ?>
            <?php foreach ($business_apply as $item ): ?>
            <tr>
              <td>
                <?php $index++ ;echo $item['department_name']?></td>
              <td>
                <?php echo $item['project_team_name']?></td>
              <td>
                <?php echo $item['staff_name']?>(<?php echo $item['job_number']?>)</td>
              <td>
                <?php echo $item['start_date']?>
                </td>
              <td>
                <?php echo $item['end_date']?>
              </td>
              <td>
                <?php if($item['project_manager_state']==0&&$item['state']==0) {?>
                  等待项目经理审批
                <?php } ?>
                <?php if($item['project_manager_state']==1&&$item['department_manager_state']==0&&$item['state']==0) {?>
                  等待部门经理审批
                <?php } ?>
                <?php if($item['project_manager_state']==1&&$item['department_manager_state']==1&&$item['vice_manager_state']==0&&$item['state']==0) {?>
                  等待副总经理审批
                <?php } ?>
                <?php if($item['project_manager_state']==1&&$item['department_manager_state']==1&&$item['vice_manager_state']==1&&$item['general_manager_state']==0&&$item['state']==0) {?>
                  等待总经理审批
                <?php } ?>
                <?php if($item['state']==1&&$item['result']==1) {?>
                  申请成功
                <?php } ?>
                <?php if($item['state']==1&&$item['result']==2) {?>
                  申请失败
                <?php } ?>
              </td>
            </tr>
            <?php endforeach; ?></tbody>
            </table>
          </div>
        </div>
      </div>
      </div>
  </div>
</div>

</body>
</html>
